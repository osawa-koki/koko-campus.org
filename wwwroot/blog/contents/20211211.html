<h1>非同期処理(js)</h1>
非同期処理って何でしょうか???<br />簡単に説明すると、<span class="underline">ある処理の完了を待たずに、次の処理へ進むこと</span>を言います。<br /><br />皆さん特に意識することはないと思いますが、我々が普段用いるプログラミング言語(現代プログラミング言語/構造化プログラミング言語)の3つの基本性質のうちの1つに<strong>順次実行</strong>があります。<br /><br />最初に1行目の命令を実行して1行目の処理が完了したら2行目の処理を開始して、2行目の処理が完了したら3行目の処理を開始して、、、<br />というように上から順にコードを実行していきます。<br />換言すれば、2行目の処理を始める際には1行目までの処理が完全に完了していて、3行目の処理を開始する際には2行目までの処理が完全に完了しているということです。<br /><br />しかしながら、これでは大きな問題があります。<br />例えば、2行目に10秒測る処理を記述した場合に一旦プログラムはそこでストップして、それ以降の処理へ進めなくなります。<br />これは資源の無駄遣いですね、、、<br />モッタイナイ!!<br /><br />ということで10秒測っている間に次の処理へ進めるようにする処理方法が非同期処理です。<br /><br />この非同期処理はhttpリクエストの送信とそのレスポンスを処理する場合(XMLHtttpRequest・Fetch)、一定期間ごとに処理を繰り返す場合(SetInterval)、一定時間後に処理を実行する場合(setTimeout)などで良く用いられます。<br><br>非常に便利ですね♪<br /><br />ですけど勘のいい方なら想像できると思いますが、これではダメな場合もあります。<br /><br />ダメな場合としてhttpリクエストを送信してそのレスポンスデータを処理する場合に、レスポンスデータがまだ届いていないのにそのデータの処理を始めようとしてしまう場合があげられます。<br /><br /><span class="underline">非同期処理では処理が実行される順番が保証されない</span>という性質がありますが、順番に処理をしなければならない場合は、コールバック関数を用いて明示的に記述する必要があります。<br />これがAの後にBを、その後にC、D、、、と長く続くとコードの可読性が損なわれるという問題があります。
<p class="r">よくコールバック地獄なんて言います。</p>
<code class="javascript">
	setTimeout(() => {
		//1000ミリ秒後に実行する処理
		setTimeout(() => {
			//さらに500ミリ秒後に実行する処理
			setTimeout(() => {
				//さらに3000ミリ秒後に実行する処理
				setTimeout(() => {
					//さらに100ミリ秒後に実行する処理
					setTimeout(() => {
						//さらに5000ミリ秒後に実行する処理
						...
					}, 5000);
				}, 100);
			}, 3000);
		}, 500);
	}, 1000);
</code>
汚い!!!<br />こんなコード嫌だ!!!<br />同期処理だったらそんなことしなくても上から順番に実行してくれるのですが、、、<br /><br />って感じで非同期処理は一長一短で、その性質からよく諸刃の剣とも形容されます。<br /><br />確かに非同期処理のデメリットは大きいんですけど、メリットはデメリットをはるかに上回ります。<br />最近はユーザに与える満足度(ユーザビリティ・UX)も特に大切にされるので、これを実現する非同期処理はかなり重宝されます。<br />非同期処理のデメリットである実行順序の保証が困難である問題に対して、最近はPromiseオブジェクトのthenメソッドで簡単に記述できるようになっています。<br /><br />また、webサーバの大きな問題である<a href="?date=20211129">C10K問題</a>の解決策としても非同期処理が採用されています。<br /><br />非常に流行に乗っている技術ですので、是非マスターしてよりよいプログラムを作成しましょう♪
<script src="../package/js-modules/koko-code/ver1.js" charset="utf-8" defer></script>